# çƒ­é—¨ç´ æç®¡ç†å¹³å° - ç³»ç»Ÿæ¶æ„æ–¹æ¡ˆ

## ä¸€ã€ç³»ç»Ÿå®šä½

è¿™ä¸æ˜¯ä¸€ä¸ªç®€å•çš„"ç´ æå¹³å°"ï¼Œè€Œæ˜¯ä¸€ä¸ª**å†…å®¹åˆ›ä½œå·¥ä½œå° + çŸ¥è¯†åº“ç³»ç»Ÿ**ã€‚

## äºŒã€æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

### 1. ç´ æç³»ç»Ÿ
- ä»å¤šå¹³å°ï¼ˆä»Šæ—¥å¤´æ¡/å…¬ä¼—å·/å°çº¢ä¹¦ï¼‰æŠ“å–çƒ­é—¨å†…å®¹
- æ”¯æŒç­›é€‰ã€æœç´¢ã€æ’åº

### 2. æ”¶è—ç³»ç»Ÿï¼ˆåŒæ¨¡å¼ï¼‰
- **æ¨¡å¼Aï¼šå¿«é€Ÿæ”¶è—** - å•ç¯‡ç´ ææ”¶è—åˆ°çµæ„Ÿåº“
- **æ¨¡å¼Bï¼šä½œè€…çŸ¥è¯†åº“** - å…³æ³¨æŸä¸ªå¤§Vï¼Œè‡ªåŠ¨åŒæ­¥TAçš„æ‰€æœ‰ä½œå“

### 3. çŸ¥è¯†åº“ç³»ç»Ÿ
- **ç³»ç»Ÿé¢„ç½®**ï¼šæ ‡é¢˜å…¬å¼ã€é‡‘å¥ã€å¼€å¤´æ¨¡æ¿ã€ç»“å°¾æ¨¡æ¿ã€è¿‡æ¸¡å¥
- **ç”¨æˆ·è‡ªå®šä¹‰**ï¼šä»ç´ æä¸­æå–çš„è¯­è¨€æªè¾ã€è§‚ç‚¹ã€è¡¨è¾¾ç»“æ„
- **AIåˆ†æ**ï¼šè‡ªåŠ¨æå–ä½œè€…æ–‡ç« çš„å†™ä½œé£æ ¼ã€é‡‘å¥ã€è§‚ç‚¹

### 4. åˆ›ä½œç³»ç»Ÿ
- **Notioné£æ ¼ç¼–è¾‘å™¨**ï¼šå¯Œæ–‡æœ¬ç¼–è¾‘ + æ–œæ å‘½ä»¤ + @å¼•ç”¨çŸ¥è¯†åº“
- **å®æ—¶é¢„è§ˆ**ï¼šå·¦ä¾§ç¼–è¾‘ï¼Œå³ä¾§é¢„è§ˆ
- **æ ·å¼ç³»ç»Ÿ**ï¼ˆå…¬ä¼—å·ç‰¹ä¾›ï¼‰ï¼š
  - æ ‡é¢˜æ ·å¼è‡ªå®šä¹‰
  - æ­£æ–‡å­—ä½“/é¢œè‰²/è¡Œè·
  - å¼•ç”¨æ¡†æ ·å¼
  - åº•éƒ¨å›ºå®šå…ƒç´ ï¼ˆå…³æ³¨åŠ¨å›¾/äºŒç»´ç /ç­¾åï¼‰

### 5. å‘å¸ƒç³»ç»Ÿ
- **ä¸ç›´æ¥å‘å¸ƒåˆ°å¹³å°**ï¼ˆAPIå¤ªéš¾æï¼‰
- **å¤åˆ¶å¯¼å‡º**ï¼šä¸€é”®å¤åˆ¶å¸¦æ ¼å¼çš„HTMLï¼Œç²˜è´´åˆ°å¹³å°ç¼–è¾‘å™¨
- **å¤šæ ¼å¼å¯¼å‡º**ï¼šHTML / Markdown / çº¯æ–‡æœ¬

## ä¸‰ã€æ•°æ®åº“è®¾è®¡

### ç”¨æˆ·ç³»ç»Ÿ
```sql
users (ç”¨æˆ·è¡¨)
- id
- username, email, password_hash
- avatar, nickname
- created_at
```

### ç´ æç³»ç»Ÿ
```sql
materials (åŸå§‹ç´ æè¡¨ - ä»å¹³å°æŠ“å–çš„)
- id
- platform (ä»Šæ—¥å¤´æ¡/å…¬ä¼—å·/å°çº¢ä¹¦)
- title, content, summary
- author, author_id, fans_count
- read_count, comment_count, like_count
- keywords (JSON)
- source_url
- published_at
- created_at
```

### æ”¶è—ç³»ç»Ÿ
```sql
collections (å¿«é€Ÿæ”¶è— - å•ç¯‡ç´ æ)
- id
- user_id
- material_id (å…³è”ç´ æ)
- folder_id (å¯é€‰ï¼Œå½’ç±»åˆ°æ–‡ä»¶å¤¹)
- notes (ä¸ªäººç¬”è®°)
- tags (è‡ªå®šä¹‰æ ‡ç­¾)
- status (å¾…æ•´ç†/æ„æ€ä¸­/ç²¾é€‰)
- created_at

author_libraries (ä½œè€…çŸ¥è¯†åº“ - å…³æ³¨æŸä¸ªå¤§Vçš„å…¨éƒ¨ä½œå“)
- id
- user_id
- platform
- author_name, author_id
- description (å¯¹è¿™ä¸ªä½œè€…çš„æè¿°)
- sync_enabled (æ˜¯å¦è‡ªåŠ¨åŒæ­¥TAçš„æ–°æ–‡ç« )
- last_sync_at
- created_at

author_articles (ä½œè€…æ–‡ç« è¡¨ - çŸ¥è¯†åº“çš„å†…å®¹)
- id
- library_id (å…³è”author_libraries)
- material_id (å…³è”materials)
- analysis (AIåˆ†æç»“æœ - JSON)
  {
    "writing_style": "æ“…é•¿ç”¨ç–‘é—®å¥å¼€å¤´...",
    "structure": "æ€»åˆ†æ€»ç»“æ„...",
    "golden_sentences": ["é‡‘å¥1", "é‡‘å¥2"],
    "viewpoints": ["è§‚ç‚¹1", "è§‚ç‚¹2"],
    "language_patterns": ["è¯­è¨€æªè¾ç‰¹ç‚¹"]
  }
- created_at
```

### é€šç”¨çŸ¥è¯†åº“ç³»ç»Ÿ
```sql
knowledge_base (çŸ¥è¯†åº“åˆ†ç±»)
- id
- user_id
- name (è¯­è¨€æªè¾/é‡‘å¥/è§‚ç‚¹/è¡¨è¾¾ç»“æ„/æ ‡é¢˜å…¬å¼...)
- type (system/custom) - ç³»ç»Ÿé¢„ç½®æˆ–ç”¨æˆ·è‡ªå®šä¹‰
- icon, color
- created_at

knowledge_items (çŸ¥è¯†åº“æ¡ç›®)
- id
- kb_id (å…³è”knowledge_base)
- content (å…·ä½“å†…å®¹)
- source_material_id (å¯é€‰ï¼Œæ¥æºç´ æ)
- source_author_library_id (å¯é€‰ï¼Œæ¥æºä½œè€…åº“)
- examples (ä½¿ç”¨ç¤ºä¾‹ - JSON)
- tags
- usage_count (ä½¿ç”¨æ¬¡æ•°ç»Ÿè®¡)
- created_at
```

### åˆ›ä½œç³»ç»Ÿ
```sql
drafts (è‰ç¨¿è¡¨)
- id
- user_id
- title, content (å¯Œæ–‡æœ¬ - JSONæ ¼å¼ï¼Œå­˜å‚¨TipTap/Slateçš„æ•°æ®ç»“æ„)
- target_platform (ä»Šæ—¥å¤´æ¡/å…¬ä¼—å·)
- status (è‰ç¨¿/ç¼–è¾‘ä¸­/å¾…å‘å¸ƒ)
- progress (å®Œæˆç™¾åˆ†æ¯”)
- references (å¼•ç”¨çš„ç´ æ/çŸ¥è¯†åº“ - JSON)
  {
    "materials": [material_ids],
    "knowledge_items": [item_ids],
    "author_articles": [article_ids]
  }
- created_at, updated_at
```

### æ ·å¼æ¨¡æ¿ç³»ç»Ÿï¼ˆå…¬ä¼—å·ï¼‰
```sql
wechat_templates (å…¬ä¼—å·æ¨¡æ¿)
- id
- user_id
- name (æ¨¡æ¿åç§°)
- type (system/custom)
- preview_image
- config (JSONé…ç½®)
  {
    "title_style": {
      "font_size": "24px",
      "color": "#000",
      "align": "center",
      "font_weight": "bold"
    },
    "content_style": {
      "font_size": "16px",
      "line_height": "1.8",
      "color": "#333"
    },
    "quote_style": {
      "border_left": "4px solid #07C160",
      "background": "#f0f0f0",
      "padding": "12px"
    },
    "footer": {
      "follow_gif": "https://xxx.gif",  // å…³æ³¨åŠ¨å›¾
      "qr_code": "https://xxx.jpg",     // äºŒç»´ç 
      "signature": "è¿™æ˜¯æˆ‘çš„ç­¾åæ¡£"
    }
  }
- created_at

published_works (å·²å‘å¸ƒä½œå“)
- id
- user_id
- draft_id
- platform
- title, content
- template_id (å…¬ä¼—å·ä½¿ç”¨çš„æ¨¡æ¿ID)
- published_at
- stats (å‘å¸ƒåçš„æ•°æ®è¿½è¸ª - JSONï¼Œæ‰‹åŠ¨è®°å½•)
- created_at
```

## å››ã€æŠ€æœ¯æ ˆå»ºè®®

### åç«¯æ–¹æ¡ˆAï¼ˆæ¨èï¼‰ï¼šPython + FastAPI
```
- FastAPI (åç«¯æ¡†æ¶) - æ€§èƒ½å¥½ï¼Œå¼‚æ­¥æ”¯æŒ
- SQLAlchemy (ORM)
- PostgreSQL (æ•°æ®åº“ï¼Œæ”¯æŒJSONå­—æ®µ)
- Redis (ç¼“å­˜ + å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—)
- Celery (å®šæ—¶ä»»åŠ¡ï¼šåŒæ­¥ä½œè€…æ–°æ–‡ç« )
- BeautifulSoup4/Playwright (çˆ¬è™«)
- JWT (ç”¨æˆ·è®¤è¯)
```

ä¼˜åŠ¿ï¼š
- Pythonçˆ¬è™«ç”Ÿæ€å®Œå–„
- AIé›†æˆæ–¹ä¾¿ï¼ˆOpenAI/æœ¬åœ°LLMï¼‰
- FastAPIæ€§èƒ½ä¼˜ç§€
- Pydanticæ•°æ®éªŒè¯

### åç«¯æ–¹æ¡ˆBï¼šNode.js + NestJS
```
- NestJS (åç«¯æ¡†æ¶)
- TypeORM
- PostgreSQL
- Bull (ä»»åŠ¡é˜Ÿåˆ—)
- Puppeteer (çˆ¬è™«)
- JWT (ç”¨æˆ·è®¤è¯)
```

ä¼˜åŠ¿ï¼š
- ä¸å‰ç«¯åŒè¯­è¨€ï¼ˆTypeScriptï¼‰
- å¾®æœåŠ¡æ¶æ„å‹å¥½

### å‰ç«¯æŠ€æœ¯æ ˆï¼ˆå·²æœ‰ï¼‰
```
- React 19.1.1
- Vite 7.1.7
- Ant Design 5.27.6
- TypeScript
- TipTap (ç¼–è¾‘å™¨ - å¾…é›†æˆ)
```

## äº”ã€æ ¸å¿ƒä¸šåŠ¡æµç¨‹

### æµç¨‹1ï¼šç´ ææ”¶è—

#### å¿«é€Ÿæ”¶è—
```
ç”¨æˆ·æ“ä½œï¼šæµè§ˆç´ æ â†’ ç‚¹å‡»"æ”¶è—"
API: POST /api/collections
è¯·æ±‚ä½“ï¼š
{
  "material_id": 123,
  "notes": "è¿™ä¸ªæ ‡é¢˜ä¸é”™",
  "tags": ["æ ‡é¢˜æŠ€å·§"],
  "status": "å¾…æ•´ç†"
}
```

#### å…³æ³¨ä½œè€…çŸ¥è¯†åº“
```
ç”¨æˆ·æ“ä½œï¼šæµè§ˆç´ æ â†’ ç‚¹å‡»ä½œè€…å â†’ "å…³æ³¨TAçš„çŸ¥è¯†åº“"
API: POST /api/author-libraries
è¯·æ±‚ä½“ï¼š
{
  "platform": "ä»Šæ—¥å¤´æ¡",
  "author_name": "å¯ä¹åŠ å†°",
  "author_id": "xxx",
  "description": "æ“…é•¿å¨±ä¹å…«å¦æ ‡é¢˜",
  "sync_enabled": true
}

åç«¯å¤„ç†ï¼š
1. åˆ›å»ºauthor_libraryè®°å½•
2. å¼‚æ­¥ä»»åŠ¡ï¼šæŠ“å–è¯¥ä½œè€…çš„å†å²æ–‡ç« ï¼ˆæœ€è¿‘100ç¯‡ï¼‰
3. æ¯ç¯‡æ–‡ç« å…¥åº“åˆ°author_articles
4. å¦‚æœsync_enabled=trueï¼Œå®šæ—¶ä»»åŠ¡æ¯å¤©æ£€æŸ¥æ–°æ–‡ç« 
5. è°ƒç”¨AIåˆ†ææ¯ç¯‡æ–‡ç« ï¼Œæå–ï¼š
   - å†™ä½œé£æ ¼
   - é‡‘å¥ï¼ˆ3-5å¥ï¼‰
   - æ ¸å¿ƒè§‚ç‚¹ï¼ˆ2-3ä¸ªï¼‰
   - è¯­è¨€ç‰¹ç‚¹
   å­˜å‚¨åˆ°analysiså­—æ®µ
```

### æµç¨‹2ï¼šçŸ¥è¯†åº“ç®¡ç†

#### ç³»ç»Ÿé¢„ç½®çŸ¥è¯†åº“ï¼ˆå¯åŠ¨æ—¶è‡ªåŠ¨åˆ›å»ºï¼‰
```
- æ ‡é¢˜å…¬å¼åº“
  - éœ‡æƒŠä½“ï¼š"éœ‡æƒŠï¼[ä¸»ä½“][åŠ¨ä½œ]ï¼Œç«Ÿç„¶[ç»“æœ]"
  - ç–‘é—®ä½“ï¼š"ä¸ºä»€ä¹ˆ[åäºº]éƒ½åœ¨[åŠ¨ä½œ]ï¼ŸçœŸç›¸è®©äºº[æƒ…ç»ª]"
  - æ•°å­—ä½“ï¼š"[æ•°å­—]ä¸ª[æ–¹æ³•]ï¼Œè®©ä½ [è¾¾æˆç›®æ ‡]"
  - å¯¹æ¯”ä½“ï¼š"æ¢åšæ˜¯ä½ ï¼Œä½ ä¼š[é€‰æ‹©A]è¿˜æ˜¯[é€‰æ‹©B]ï¼Ÿ"

- é‡‘å¥åº“
  - åŠ±å¿—ç±»ï¼š"..."
  - æ·±åº¦ç±»ï¼š"..."
  - æç¬‘ç±»ï¼š"..."

- å¼€å¤´æ¨¡æ¿åº“
  - æ•…äº‹å¼€å¤´ï¼š"..."
  - æ•°æ®å¼€å¤´ï¼š"..."
  - æé—®å¼€å¤´ï¼š"..."

- ç»“å°¾æ¨¡æ¿åº“
- è¿‡æ¸¡å¥åº“
```

#### ç”¨æˆ·åˆ›å»ºè‡ªå®šä¹‰çŸ¥è¯†åº“
```
API: POST /api/knowledge-bases
{
  "name": "æˆ‘çš„æ ‡é¢˜å…¬å¼",
  "icon": "ğŸ’¡",
  "color": "#FF6600"
}

API: POST /api/knowledge-items
{
  "kb_id": 123,
  "content": "ã€Šä¸ºä»€ä¹ˆ[åäºº]éƒ½åœ¨[åŠ¨ä½œ]ï¼ŸçœŸç›¸è®©äºº[æƒ…ç»ª]ã€‹",
  "source_material_id": 456,  // å¯é€‰
  "examples": ["ä¸ºä»€ä¹ˆé©¬äº‘éƒ½åœ¨è¯»ä¹¦ï¼ŸçœŸç›¸è®©äººæ·±æ€"],
  "tags": ["ç–‘é—®ä½“", "åäºº"]
}
```

#### ä»ç´ æå¿«é€Ÿæå–åˆ°çŸ¥è¯†åº“
```
ç”¨æˆ·æ“ä½œï¼šæµè§ˆç´ æ â†’ é€‰ä¸­ä¸€å¥è¯ â†’ å³é”®"æ·»åŠ åˆ°çŸ¥è¯†åº“" â†’ é€‰æ‹©åˆ†ç±»

API: POST /api/knowledge-items/quick-add
{
  "kb_id": 123,
  "content": "é€‰ä¸­çš„è¿™å¥è¯",
  "source_material_id": 789
}
```

### æµç¨‹3ï¼šåˆ›ä½œæµç¨‹

#### 3.1 åˆ›å»ºè‰ç¨¿
```
æ–¹å¼Aï¼šä»ç©ºç™½å¼€å§‹
API: POST /api/drafts
{
  "title": "æ–°æ–‡ç« ",
  "target_platform": "å…¬ä¼—å·"
}

æ–¹å¼Bï¼šä»ç´ æçµæ„Ÿå¼€å§‹
API: POST /api/drafts/from-materials
{
  "material_ids": [1, 2, 3],
  "target_platform": "å…¬ä¼—å·"
}
åç«¯ä¼šè‡ªåŠ¨æå–ç´ æçš„æ ‡é¢˜/è§‚ç‚¹ä½œä¸ºå‚è€ƒå†…å®¹
```

#### 3.2 ç¼–è¾‘å™¨åŠŸèƒ½ï¼ˆNotioné£æ ¼ï¼‰
```
ç¼–è¾‘å™¨æ ¸å¿ƒåŠŸèƒ½ï¼š
- å¯Œæ–‡æœ¬ç¼–è¾‘ï¼ˆæ ‡é¢˜/æ­£æ–‡/å¼•ç”¨/åˆ—è¡¨/å›¾ç‰‡ï¼‰
- æ–œæ å‘½ä»¤
  /h1, /h2, /h3 - æ ‡é¢˜
  /p - æ®µè½
  /quote - å¼•ç”¨
  /ul, /ol - åˆ—è¡¨
  /image - æ’å…¥å›¾ç‰‡
  /divider - åˆ†å‰²çº¿

- @ å¼•ç”¨çŸ¥è¯†åº“
  @é‡‘å¥ - å¼¹å‡ºé‡‘å¥åº“ï¼Œé€‰æ‹©æ’å…¥
  @æ ‡é¢˜å…¬å¼ - å¼¹å‡ºæ ‡é¢˜å…¬å¼åº“
  @ä½œè€… - å¼¹å‡ºå…³æ³¨çš„ä½œè€…åº“ï¼Œé€‰æ‹©å‚è€ƒ

- å®æ—¶è‡ªåŠ¨ä¿å­˜ï¼ˆ3ç§’é˜²æŠ–ï¼‰
  PUT /api/drafts/:id
  {
    "content": {...},  // TipTap JSONæ ¼å¼
    "updated_at": "..."
  }

æ•°æ®ç»“æ„ï¼ˆTipTap JSONï¼‰ï¼š
{
  "type": "doc",
  "content": [
    {
      "type": "heading",
      "attrs": { "level": 1 },
      "content": [{ "type": "text", "text": "æ ‡é¢˜" }]
    },
    {
      "type": "paragraph",
      "content": [
        { "type": "text", "text": "æ­£æ–‡..." },
        {
          "type": "knowledge_reference",  // è‡ªå®šä¹‰èŠ‚ç‚¹
          "attrs": {
            "kb_item_id": 123,
            "content": "è¿™æ˜¯å¼•ç”¨çš„é‡‘å¥"
          }
        }
      ]
    }
  ]
}
```

#### 3.3 é¢„è§ˆ + æ ·å¼è‡ªå®šä¹‰ï¼ˆå…¬ä¼—å·ï¼‰
```
UIå¸ƒå±€ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [è‰ç¨¿æ ‡é¢˜] [ä¿å­˜] [å¯¼å‡º] [å‘å¸ƒ]               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              â”‚              â”‚  æ ·å¼é…ç½®        â”‚
â”‚  ç¼–è¾‘å™¨      â”‚  å®æ—¶é¢„è§ˆ    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  (TipTap)    â”‚  (åº”ç”¨æ ·å¼)  â”‚  â–¡ é€‰æ‹©æ¨¡æ¿     â”‚
â”‚              â”‚              â”‚  â–¡ æ ‡é¢˜æ ·å¼     â”‚
â”‚              â”‚              â”‚  â–¡ æ­£æ–‡æ ·å¼     â”‚
â”‚              â”‚              â”‚  â–¡ å¼•ç”¨æ ·å¼     â”‚
â”‚              â”‚              â”‚  â–¡ åº•éƒ¨å…ƒç´      â”‚
â”‚              â”‚              â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ ·å¼é…ç½®ä¿å­˜ï¼š
PUT /api/drafts/:id/style
{
  "template_id": 5,  // æˆ–nullï¼ˆè‡ªå®šä¹‰ï¼‰
  "custom_style": {
    "title_style": {...},
    "content_style": {...}
  }
}

é¢„è§ˆæ¸²æŸ“ï¼š
å‰ç«¯æ ¹æ®styleé…ç½®ï¼ŒåŠ¨æ€ç”ŸæˆCSSï¼Œåº”ç”¨åˆ°é¢„è§ˆåŒº
```

#### 3.4 å¤åˆ¶å‘å¸ƒ
```
ç”¨æˆ·æ“ä½œï¼šç¼–è¾‘å®Œæˆ â†’ é€‰æ‹©æ ·å¼ â†’ ç‚¹å‡»"å¤åˆ¶HTML"

API: POST /api/drafts/:id/export
è¯·æ±‚ä½“ï¼š
{
  "format": "html",  // html/markdown/text
  "apply_style": true,
  "template_id": 5
}

è¿”å›ï¼š
{
  "html": "<div style='...'>...</div>",
  "markdown": "# æ ‡é¢˜\n...",
  "plain_text": "..."
}

å‰ç«¯å¤„ç†ï¼š
1. æ¥æ”¶HTML
2. å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼ˆä¿ç•™æ ¼å¼ï¼‰
3. æç¤ºç”¨æˆ·"å·²å¤åˆ¶ï¼Œå¯ç²˜è´´åˆ°å…¬ä¼—å·ç¼–è¾‘å™¨"

ç”¨æˆ·æ‰‹åŠ¨ï¼š
1. æ‰“å¼€å…¬ä¼—å·åå°
2. æ–°å»ºå›¾æ–‡
3. Ctrl+V ç²˜è´´ï¼ˆä¿ç•™æ ·å¼ï¼‰
4. å‘å¸ƒ

å¯é€‰ï¼šæ ‡è®°ä¸º"å·²å‘å¸ƒ"
POST /api/published-works
{
  "draft_id": 123,
  "platform": "å…¬ä¼—å·",
  "published_at": "2025-10-23 10:00:00"
}
```

### æµç¨‹4ï¼šä½œè€…çŸ¥è¯†åº“åŒæ­¥ï¼ˆåå°ä»»åŠ¡ï¼‰
```
Celeryå®šæ—¶ä»»åŠ¡ï¼ˆæ¯å¤©å‡Œæ™¨2ç‚¹ï¼‰ï¼š
1. æŸ¥è¯¢æ‰€æœ‰sync_enabled=trueçš„author_libraries
2. å¯¹æ¯ä¸ªä½œè€…ï¼š
   a. è®¿é—®ä½œè€…ä¸»é¡µ
   b. è·å–æœ€æ–°æ–‡ç« åˆ—è¡¨
   c. å¯¹æ¯”last_sync_atï¼Œæ‰¾å‡ºæ–°æ–‡ç« 
   d. ä¸‹è½½æ–°æ–‡ç« å†…å®¹
   e. è°ƒç”¨AIåˆ†æï¼ˆOpenAI GPT-4æˆ–æœ¬åœ°Llamaï¼‰
   f. ä¿å­˜åˆ°author_articles
   g. æ›´æ–°last_sync_at
```

## å…­ã€APIè®¾è®¡æ¦‚è§ˆ

### è®¤è¯ç›¸å…³
```
POST   /api/auth/register          # æ³¨å†Œ
POST   /api/auth/login             # ç™»å½•
GET    /api/auth/me                # è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
POST   /api/auth/logout            # ç™»å‡º
```

### ç´ æç®¡ç†
```
GET    /api/materials              # ç´ æåˆ—è¡¨ï¼ˆå¸¦ç­›é€‰ï¼‰
  ?platform=ä»Šæ—¥å¤´æ¡
  &contentType=çŸ­å›¾æ–‡
  &category=å¨±ä¹
  &fansLimit=1000-5000
  &timeRange=1d
  &sortBy=1
  &page=1&pageSize=20

GET    /api/materials/:id          # ç´ æè¯¦æƒ…
POST   /api/materials/search       # å…³é”®è¯æœç´¢
```

### æ”¶è—ç³»ç»Ÿ
```
# å¿«é€Ÿæ”¶è—
GET    /api/collections            # æˆ‘çš„æ”¶è—åˆ—è¡¨
  ?status=å¾…æ•´ç†|æ„æ€ä¸­|ç²¾é€‰
  &folder_id=123
POST   /api/collections            # æ·»åŠ æ”¶è—
PUT    /api/collections/:id        # æ›´æ–°æ”¶è—ï¼ˆç¬”è®°/æ ‡ç­¾/çŠ¶æ€ï¼‰
DELETE /api/collections/:id        # åˆ é™¤æ”¶è—

# ä½œè€…çŸ¥è¯†åº“
GET    /api/author-libraries       # æˆ‘å…³æ³¨çš„ä½œè€…åˆ—è¡¨
POST   /api/author-libraries       # å…³æ³¨æ–°ä½œè€…
GET    /api/author-libraries/:id   # ä½œè€…è¯¦æƒ…
DELETE /api/author-libraries/:id   # å–æ¶ˆå…³æ³¨
POST   /api/author-libraries/:id/sync  # æ‰‹åŠ¨åŒæ­¥æ–°æ–‡ç« 

GET    /api/author-libraries/:id/articles  # æŸä½œè€…çš„æ–‡ç« åˆ—è¡¨
  ?page=1&pageSize=20
GET    /api/author-articles/:id    # æ–‡ç« è¯¦æƒ…ï¼ˆå«AIåˆ†æï¼‰
```

### çŸ¥è¯†åº“ç³»ç»Ÿ
```
GET    /api/knowledge-bases        # çŸ¥è¯†åº“åˆ†ç±»åˆ—è¡¨
  ?type=system|custom
POST   /api/knowledge-bases        # åˆ›å»ºæ–°åˆ†ç±»
PUT    /api/knowledge-bases/:id    # æ›´æ–°åˆ†ç±»
DELETE /api/knowledge-bases/:id    # åˆ é™¤åˆ†ç±»

GET    /api/knowledge-items        # æŸåˆ†ç±»çš„æ¡ç›®åˆ—è¡¨
  ?kb_id=123
  &tags=æ ‡é¢˜,ç–‘é—®ä½“
  &page=1&pageSize=20
POST   /api/knowledge-items        # æ·»åŠ æ¡ç›®
POST   /api/knowledge-items/quick-add  # ä»ç´ æå¿«é€Ÿæå–
PUT    /api/knowledge-items/:id    # æ›´æ–°æ¡ç›®
DELETE /api/knowledge-items/:id    # åˆ é™¤æ¡ç›®

GET    /api/knowledge-items/search # æœç´¢çŸ¥è¯†åº“
  ?q=å…³é”®è¯
```

### è‰ç¨¿ç³»ç»Ÿ
```
GET    /api/drafts                 # è‰ç¨¿åˆ—è¡¨
  ?status=è‰ç¨¿|ç¼–è¾‘ä¸­|å¾…å‘å¸ƒ
  &platform=ä»Šæ—¥å¤´æ¡|å…¬ä¼—å·
POST   /api/drafts                 # æ–°å»ºè‰ç¨¿
POST   /api/drafts/from-materials  # ä»ç´ æåˆ›å»ºè‰ç¨¿
GET    /api/drafts/:id             # è‰ç¨¿è¯¦æƒ…
PUT    /api/drafts/:id             # ä¿å­˜ç¼–è¾‘
PUT    /api/drafts/:id/style       # ä¿å­˜æ ·å¼é…ç½®
DELETE /api/drafts/:id             # åˆ é™¤è‰ç¨¿

POST   /api/drafts/:id/export      # å¯¼å‡ºï¼ˆå¤åˆ¶ç”¨ï¼‰
  Body: { format: "html|markdown|text", apply_style: true }
```

### æ¨¡æ¿ç³»ç»Ÿï¼ˆå…¬ä¼—å·ï¼‰
```
GET    /api/wechat-templates       # æ¨¡æ¿åˆ—è¡¨
  ?type=system|custom
POST   /api/wechat-templates       # åˆ›å»ºæ¨¡æ¿
GET    /api/wechat-templates/:id   # æ¨¡æ¿è¯¦æƒ…
PUT    /api/wechat-templates/:id   # æ›´æ–°æ¨¡æ¿
DELETE /api/wechat-templates/:id   # åˆ é™¤æ¨¡æ¿
```

### å‘å¸ƒç®¡ç†
```
GET    /api/published-works        # å·²å‘å¸ƒä½œå“åˆ—è¡¨
  ?platform=ä»Šæ—¥å¤´æ¡|å…¬ä¼—å·
POST   /api/published-works        # æ ‡è®°ä¸ºå·²å‘å¸ƒ
GET    /api/published-works/:id    # ä½œå“è¯¦æƒ…
PUT    /api/published-works/:id/stats  # æ›´æ–°æ•°æ®ï¼ˆæ‰‹åŠ¨è®°å½•ï¼‰
DELETE /api/published-works/:id    # åˆ é™¤è®°å½•
```

## ä¸ƒã€å¼€å‘é˜¶æ®µè§„åˆ’

### Phase 1: MVPï¼ˆ2å‘¨ï¼‰
**ç›®æ ‡ï¼š** åŸºç¡€åŠŸèƒ½å¯ç”¨ï¼Œèƒ½å®Œæˆ"å‘ç°â†’æ”¶è—â†’ç¼–è¾‘â†’å¤åˆ¶"æµç¨‹

**åç«¯ï¼š**
- [ ] ç”¨æˆ·æ³¨å†Œ/ç™»å½•ï¼ˆJWTï¼‰
- [ ] ç´ æAPIï¼ˆå¯¹æ¥ç°æœ‰æ•°æ®æºï¼‰
- [ ] å¿«é€Ÿæ”¶è—åŠŸèƒ½
- [ ] ç®€å•è‰ç¨¿CRUD
- [ ] Markdownå¯¼å‡º

**å‰ç«¯ï¼š**
- [ ] ç™»å½•æ³¨å†Œé¡µé¢
- [ ] ç´ ææµè§ˆï¼ˆè¡¨æ ¼/å¡ç‰‡åˆ‡æ¢ï¼‰
- [ ] æ”¶è—åŠŸèƒ½UI
- [ ] Markdownç¼–è¾‘å™¨ï¼ˆç®€å•ç‰ˆï¼‰
- [ ] å¤åˆ¶å¯¼å‡ºåŠŸèƒ½

### Phase 2: æ ¸å¿ƒåŠŸèƒ½ï¼ˆ3å‘¨ï¼‰
**ç›®æ ‡ï¼š** çŸ¥è¯†åº“ + é«˜çº§ç¼–è¾‘å™¨ + å…¬ä¼—å·æ ·å¼

**åç«¯ï¼š**
- [ ] ä½œè€…çŸ¥è¯†åº“ï¼ˆæ‰‹åŠ¨åŒæ­¥ï¼‰
- [ ] é€šç”¨çŸ¥è¯†åº“CRUD
- [ ] TipTapå†…å®¹å­˜å‚¨/è¯»å–
- [ ] å…¬ä¼—å·æ¨¡æ¿ç³»ç»Ÿ
- [ ] HTMLå¯¼å‡ºï¼ˆå¸¦æ ·å¼ï¼‰

**å‰ç«¯ï¼š**
- [ ] ä½œè€…çŸ¥è¯†åº“é¡µé¢
- [ ] çŸ¥è¯†åº“ç®¡ç†é¡µé¢
- [ ] TipTapç¼–è¾‘å™¨é›†æˆ
- [ ] @ å¼•ç”¨çŸ¥è¯†åº“åŠŸèƒ½
- [ ] å®æ—¶é¢„è§ˆ + æ ·å¼é…ç½®
- [ ] æ¨¡æ¿ç®¡ç†é¡µé¢

### Phase 3: AIå¢å¼ºï¼ˆåç»­ï¼‰
**ç›®æ ‡ï¼š** AIè¾…åŠ©åˆ›ä½œï¼Œè‡ªåŠ¨åŒ–çŸ¥è¯†æå–

**åç«¯ï¼š**
- [ ] é›†æˆOpenAI API / æœ¬åœ°LLM
- [ ] AIåˆ†ææ–‡ç« ï¼ˆé‡‘å¥/è§‚ç‚¹æå–ï¼‰
- [ ] ä½œè€…çŸ¥è¯†åº“è‡ªåŠ¨åŒæ­¥ï¼ˆCeleryä»»åŠ¡ï¼‰
- [ ] AIæ¨èçŸ¥è¯†åº“æ¡ç›®
- [ ] AIè¾…åŠ©åˆ›ä½œï¼ˆæ ‡é¢˜ç”Ÿæˆ/ç»­å†™ï¼‰

**å‰ç«¯ï¼š**
- [ ] AIåˆ†æç»“æœå±•ç¤º
- [ ] AIæ¨èé¢æ¿
- [ ] AIè¾…åŠ©åˆ›ä½œæŒ‰é’®

### Phase 4: ä¼˜åŒ–ä¸æ‰©å±•ï¼ˆæŒç»­ï¼‰
- [ ] æ•°æ®åˆ†æä»ªè¡¨ç›˜
- [ ] å›¢é˜Ÿåä½œåŠŸèƒ½
- [ ] æ›´å¤šå¹³å°æ¥å…¥ï¼ˆå°çº¢ä¹¦/Bç«™ï¼‰
- [ ] ç§»åŠ¨ç«¯é€‚é…
- [ ] æµè§ˆå™¨æ’ä»¶ï¼ˆå¿«é€Ÿæ”¶è—ï¼‰

## å…«ã€æŠ€æœ¯é€‰å‹å¾…å®šé—®é¢˜

### éœ€è¦ç¡®å®šï¼š
1. **åç«¯æ¡†æ¶ï¼š** Python FastAPI / Node.js NestJSï¼Ÿ
2. **æ•°æ®åº“ï¼š** PostgreSQL / MySQLï¼Ÿï¼ˆå»ºè®®PostgreSQLï¼‰
3. **ç¼–è¾‘å™¨ï¼š** TipTap / Slate / Quillï¼Ÿï¼ˆå»ºè®®TipTapï¼‰
4. **AIæœåŠ¡ï¼š** OpenAI GPT-4 / Claude / æœ¬åœ°Llamaï¼Ÿ
5. **éƒ¨ç½²æ–¹å¼ï¼š** Docker / äº‘æœåŠ¡å™¨ / Serverlessï¼Ÿ

## ä¹ã€ç›®å½•ç»“æ„å»ºè®®

### åç«¯ï¼ˆPython FastAPIï¼‰
```
backend/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main.py                 # FastAPIå…¥å£
â”‚   â”œâ”€â”€ config.py               # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ database.py             # æ•°æ®åº“è¿æ¥
â”‚   â”‚
â”‚   â”œâ”€â”€ models/                 # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ user.py
â”‚   â”‚   â”œâ”€â”€ material.py
â”‚   â”‚   â”œâ”€â”€ collection.py
â”‚   â”‚   â”œâ”€â”€ author_library.py
â”‚   â”‚   â”œâ”€â”€ knowledge.py
â”‚   â”‚   â”œâ”€â”€ draft.py
â”‚   â”‚   â””â”€â”€ template.py
â”‚   â”‚
â”‚   â”œâ”€â”€ schemas/                # PydanticéªŒè¯æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ user.py
â”‚   â”‚   â”œâ”€â”€ material.py
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ api/                    # APIè·¯ç”±
â”‚   â”‚   â”œâ”€â”€ auth.py
â”‚   â”‚   â”œâ”€â”€ materials.py
â”‚   â”‚   â”œâ”€â”€ collections.py
â”‚   â”‚   â”œâ”€â”€ author_libraries.py
â”‚   â”‚   â”œâ”€â”€ knowledge.py
â”‚   â”‚   â”œâ”€â”€ drafts.py
â”‚   â”‚   â””â”€â”€ templates.py
â”‚   â”‚
â”‚   â”œâ”€â”€ services/               # ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ material_service.py
â”‚   â”‚   â”œâ”€â”€ collection_service.py
â”‚   â”‚   â”œâ”€â”€ knowledge_service.py
â”‚   â”‚   â”œâ”€â”€ draft_service.py
â”‚   â”‚   â””â”€â”€ export_service.py
â”‚   â”‚
â”‚   â”œâ”€â”€ crawlers/               # çˆ¬è™«æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ toutiao.py
â”‚   â”‚   â”œâ”€â”€ wechat.py
â”‚   â”‚   â””â”€â”€ xiaohongshu.py
â”‚   â”‚
â”‚   â”œâ”€â”€ ai/                     # AIæœåŠ¡
â”‚   â”‚   â”œâ”€â”€ analyzer.py         # æ–‡ç« åˆ†æ
â”‚   â”‚   â”œâ”€â”€ generator.py        # å†…å®¹ç”Ÿæˆ
â”‚   â”‚   â””â”€â”€ recommender.py      # æ¨èç³»ç»Ÿ
â”‚   â”‚
â”‚   â””â”€â”€ utils/                  # å·¥å…·å‡½æ•°
â”‚       â”œâ”€â”€ auth.py
â”‚       â”œâ”€â”€ html_export.py
â”‚       â””â”€â”€ markdown_export.py
â”‚
â”œâ”€â”€ alembic/                    # æ•°æ®åº“è¿ç§»
â”œâ”€â”€ tests/                      # æµ‹è¯•
â”œâ”€â”€ requirements.txt
â””â”€â”€ README.md
```

### å‰ç«¯ï¼ˆReact + TypeScriptï¼‰
```
src/
â”œâ”€â”€ components/                 # é€šç”¨ç»„ä»¶
â”‚   â”œâ”€â”€ ContentTable.tsx       # è¡¨æ ¼è§†å›¾
â”‚   â”œâ”€â”€ ContentCards.tsx       # å¡ç‰‡è§†å›¾
â”‚   â”œâ”€â”€ FilterPanel.tsx        # ç­›é€‰é¢æ¿
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ pages/                      # é¡µé¢
â”‚   â”œâ”€â”€ Auth/
â”‚   â”‚   â”œâ”€â”€ Login.tsx
â”‚   â”‚   â””â”€â”€ Register.tsx
â”‚   â”œâ”€â”€ Materials/              # å‘ç°ç´ æ
â”‚   â”‚   â””â”€â”€ MaterialList.tsx
â”‚   â”œâ”€â”€ Collections/            # çµæ„Ÿåº“
â”‚   â”‚   â””â”€â”€ CollectionBoard.tsx
â”‚   â”œâ”€â”€ AuthorLibrary/          # ä½œè€…çŸ¥è¯†åº“
â”‚   â”‚   â”œâ”€â”€ AuthorList.tsx
â”‚   â”‚   â””â”€â”€ AuthorDetail.tsx
â”‚   â”œâ”€â”€ Knowledge/              # é€šç”¨çŸ¥è¯†åº“
â”‚   â”‚   â”œâ”€â”€ KnowledgeBase.tsx
â”‚   â”‚   â””â”€â”€ KnowledgeItems.tsx
â”‚   â”œâ”€â”€ Drafts/                 # åˆ›ä½œä¸­
â”‚   â”‚   â”œâ”€â”€ DraftList.tsx
â”‚   â”‚   â””â”€â”€ DraftEditor.tsx
â”‚   â”œâ”€â”€ Works/                  # ä½œå“åº“
â”‚   â”‚   â””â”€â”€ WorksList.tsx
â”‚   â””â”€â”€ Templates/              # æ¨¡æ¿ç®¡ç†
â”‚       â””â”€â”€ TemplateManager.tsx
â”‚
â”œâ”€â”€ features/                   # åŠŸèƒ½æ¨¡å—
â”‚   â”œâ”€â”€ editor/                 # ç¼–è¾‘å™¨ç›¸å…³
â”‚   â”‚   â”œâ”€â”€ TipTapEditor.tsx
â”‚   â”‚   â”œâ”€â”€ StylePanel.tsx
â”‚   â”‚   â”œâ”€â”€ PreviewPane.tsx
â”‚   â”‚   â””â”€â”€ KnowledgeReference.tsx
â”‚   â””â”€â”€ export/                 # å¯¼å‡ºåŠŸèƒ½
â”‚       â””â”€â”€ ExportModal.tsx
â”‚
â”œâ”€â”€ hooks/                      # è‡ªå®šä¹‰Hooks
â”‚   â”œâ”€â”€ useAuth.ts
â”‚   â”œâ”€â”€ useMaterials.ts
â”‚   â”œâ”€â”€ useKnowledge.ts
â”‚   â””â”€â”€ useDrafts.ts
â”‚
â”œâ”€â”€ services/                   # APIè°ƒç”¨
â”‚   â”œâ”€â”€ api.ts
â”‚   â”œâ”€â”€ authService.ts
â”‚   â”œâ”€â”€ materialService.ts
â”‚   â”œâ”€â”€ knowledgeService.ts
â”‚   â””â”€â”€ draftService.ts
â”‚
â”œâ”€â”€ types/                      # TypeScriptç±»å‹
â”‚   â”œâ”€â”€ material.ts
â”‚   â”œâ”€â”€ collection.ts
â”‚   â”œâ”€â”€ knowledge.ts
â”‚   â””â”€â”€ draft.ts
â”‚
â”œâ”€â”€ utils/                      # å·¥å…·å‡½æ•°
â”œâ”€â”€ styles/                     # å…¨å±€æ ·å¼
â”œâ”€â”€ App.tsx
â””â”€â”€ main.tsx
```

## åã€æ³¨æ„äº‹é¡¹

### å®‰å…¨æ€§
- [ ] ç”¨æˆ·å¯†ç bcryptåŠ å¯†
- [ ] JWT Tokenè¿‡æœŸæœºåˆ¶
- [ ] APIé€Ÿç‡é™åˆ¶
- [ ] XSSé˜²æŠ¤ï¼ˆç¼–è¾‘å™¨å†…å®¹è¿‡æ»¤ï¼‰
- [ ] CSRFé˜²æŠ¤

### æ€§èƒ½ä¼˜åŒ–
- [ ] ç´ æåˆ—è¡¨åˆ†é¡µ/è™šæ‹Ÿæ»šåŠ¨
- [ ] Redisç¼“å­˜çƒ­é—¨æ•°æ®
- [ ] å›¾ç‰‡CDN
- [ ] ç¼–è¾‘å™¨é˜²æŠ–ä¿å­˜
- [ ] æ‡’åŠ è½½çŸ¥è¯†åº“

### ç”¨æˆ·ä½“éªŒ
- [ ] åŠ è½½çŠ¶æ€æç¤º
- [ ] é”™è¯¯æç¤ºå‹å¥½
- [ ] é”®ç›˜å¿«æ·é”®ï¼ˆCtrl+Sä¿å­˜ï¼‰
- [ ] æš—é»‘æ¨¡å¼æ”¯æŒ
- [ ] ç§»åŠ¨ç«¯é€‚é…

---

**æ–‡æ¡£ç‰ˆæœ¬ï¼š** v1.0
**åˆ›å»ºæ—¶é—´ï¼š** 2025-10-23
**æœ€åæ›´æ–°ï¼š** 2025-10-23
