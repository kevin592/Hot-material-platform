<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å†…å®¹ç¼–è¾‘å™¨ - Notioné£æ ¼</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --bg-primary: #ffffff;
      --bg-secondary: #f8f9fa;
      --bg-tertiary: #f1f3f5;
      --text-primary: #212529;
      --text-secondary: #495057;
      --text-tertiary: #868e96;
      --border-color: #dee2e6;
      --accent-color: #228be6;
      --accent-hover: #1c7ed6;
      --success-color: #51cf66;
      --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.06);
      --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.08);
      --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.12);
      --radius-sm: 6px;
      --radius-md: 8px;
      --radius-lg: 12px;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
      background: var(--bg-secondary);
      color: var(--text-primary);
      line-height: 1.6;
    }

    /* é¡¶éƒ¨å·¥å…·æ  */
    .top-toolbar {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 56px;
      background: var(--bg-primary);
      border-bottom: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      padding: 0 20px;
      z-index: 1000;
      gap: 16px;
    }

    .draft-title-input {
      flex: 1;
      max-width: 400px;
      border: none;
      font-size: 15px;
      font-weight: 500;
      padding: 8px 12px;
      background: var(--bg-secondary);
      border-radius: var(--radius-md);
      transition: all 0.2s;
    }

    .draft-title-input:focus {
      outline: none;
      background: var(--bg-primary);
      box-shadow: 0 0 0 2px var(--accent-color);
    }

    .toolbar-actions {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-left: auto;
    }

    .toolbar-btn {
      height: 36px;
      padding: 0 16px;
      border: none;
      border-radius: var(--radius-md);
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .toolbar-btn.secondary {
      background: var(--bg-secondary);
      color: var(--text-primary);
    }

    .toolbar-btn.secondary:hover {
      background: var(--bg-tertiary);
    }

    .toolbar-btn.primary {
      background: var(--accent-color);
      color: white;
    }

    .toolbar-btn.primary:hover {
      background: var(--accent-hover);
      transform: translateY(-1px);
      box-shadow: var(--shadow-md);
    }

    .save-indicator {
      font-size: 13px;
      color: var(--text-tertiary);
      padding: 0 12px;
    }

    .save-indicator.saved {
      color: var(--success-color);
    }

    /* ä¸»ç¼–è¾‘åŒºåŸŸ */
    .editor-layout {
      display: grid;
      grid-template-columns: 1fr 1fr 320px;
      gap: 0;
      margin-top: 56px;
      height: calc(100vh - 56px);
    }

    /* ç¼–è¾‘å™¨é¢æ¿ */
    .editor-panel {
      background: var(--bg-primary);
      border-right: 1px solid var(--border-color);
      overflow-y: auto;
      padding: 32px;
    }

    .editor-container {
      max-width: 720px;
      margin: 0 auto;
    }

    .editor-title {
      font-size: 32px;
      font-weight: 700;
      border: none;
      outline: none;
      width: 100%;
      padding: 12px 0;
      margin-bottom: 8px;
      resize: none;
      overflow: hidden;
      line-height: 1.3;
    }

    .editor-title::placeholder {
      color: var(--text-tertiary);
    }

    .editor-content {
      min-height: 400px;
      font-size: 16px;
      line-height: 1.75;
    }

    .editor-block {
      margin-bottom: 12px;
      position: relative;
      padding: 8px 0;
      transition: all 0.15s;
    }

    .editor-block:hover {
      background: var(--bg-secondary);
      border-radius: var(--radius-sm);
      margin-left: -8px;
      margin-right: -8px;
      padding-left: 8px;
      padding-right: 8px;
    }

    .editor-block:hover .block-handle {
      opacity: 1;
    }

    .block-handle {
      position: absolute;
      left: -24px;
      top: 50%;
      transform: translateY(-50%);
      width: 16px;
      height: 16px;
      opacity: 0;
      cursor: grab;
      color: var(--text-tertiary);
      font-size: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .editor-input {
      width: 100%;
      border: none;
      outline: none;
      font-size: 16px;
      line-height: 1.75;
      padding: 4px 0;
      background: transparent;
      color: var(--text-primary);
    }

    .editor-input::placeholder {
      color: var(--text-tertiary);
    }

    .editor-heading-1 {
      font-size: 28px;
      font-weight: 700;
      line-height: 1.3;
      margin: 24px 0 12px;
    }

    .editor-heading-2 {
      font-size: 22px;
      font-weight: 700;
      line-height: 1.3;
      margin: 20px 0 10px;
    }

    .editor-heading-3 {
      font-size: 18px;
      font-weight: 600;
      line-height: 1.4;
      margin: 16px 0 8px;
    }

    .editor-quote {
      border-left: 3px solid var(--accent-color);
      padding-left: 16px;
      margin: 12px 0;
      color: var(--text-secondary);
      font-style: italic;
    }

    .editor-divider {
      height: 1px;
      background: var(--border-color);
      margin: 20px 0;
      border: none;
    }

    .slash-menu {
      position: absolute;
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-md);
      box-shadow: var(--shadow-lg);
      padding: 8px;
      min-width: 280px;
      z-index: 100;
      display: none;
    }

    .slash-menu.active {
      display: block;
    }

    .slash-menu-item {
      padding: 10px 12px;
      border-radius: var(--radius-sm);
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 12px;
      transition: all 0.15s;
      font-size: 14px;
    }

    .slash-menu-item:hover {
      background: var(--bg-secondary);
    }

    .slash-menu-item.selected {
      background: var(--accent-color);
      color: white;
    }

    .slash-menu-icon {
      width: 20px;
      text-align: center;
      font-size: 16px;
    }

    .slash-menu-label {
      flex: 1;
      font-weight: 500;
    }

    .slash-menu-shortcut {
      font-size: 12px;
      color: var(--text-tertiary);
      padding: 2px 6px;
      background: var(--bg-tertiary);
      border-radius: 3px;
    }

    /* @ å¼•ç”¨èœå• */
    .reference-menu {
      position: absolute;
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-md);
      box-shadow: var(--shadow-lg);
      padding: 8px;
      width: 320px;
      max-height: 400px;
      overflow-y: auto;
      z-index: 100;
      display: none;
    }

    .reference-menu.active {
      display: block;
    }

    .reference-category {
      padding: 8px 12px;
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: var(--text-tertiary);
    }

    .reference-item {
      padding: 10px 12px;
      border-radius: var(--radius-sm);
      cursor: pointer;
      transition: all 0.15s;
      font-size: 14px;
      line-height: 1.5;
    }

    .reference-item:hover {
      background: var(--bg-secondary);
    }

    .reference-item.selected {
      background: var(--accent-color);
      color: white;
    }

    .reference-tag {
      display: inline-block;
      background: var(--accent-color);
      color: white;
      padding: 2px 8px;
      border-radius: 4px;
      font-size: 13px;
      margin: 0 2px;
      cursor: pointer;
    }

    .reference-tag:hover {
      background: var(--accent-hover);
    }

    /* é¢„è§ˆé¢æ¿ */
    .preview-panel {
      background: var(--bg-secondary);
      border-right: 1px solid var(--border-color);
      overflow-y: auto;
      padding: 32px 24px;
    }

    .preview-container {
      max-width: 720px;
      margin: 0 auto;
      background: var(--bg-primary);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-md);
      padding: 48px;
      min-height: calc(100vh - 120px);
    }

    .preview-title {
      font-size: 28px;
      font-weight: 700;
      line-height: 1.3;
      margin-bottom: 20px;
      color: var(--text-primary);
    }

    .preview-meta {
      font-size: 14px;
      color: var(--text-tertiary);
      padding-bottom: 20px;
      margin-bottom: 24px;
      border-bottom: 1px solid var(--border-color);
    }

    .preview-content {
      font-size: 16px;
      line-height: 1.75;
      color: var(--text-primary);
    }

    .preview-content h1 {
      font-size: 26px;
      font-weight: 700;
      margin: 32px 0 16px;
    }

    .preview-content h2 {
      font-size: 22px;
      font-weight: 700;
      margin: 28px 0 14px;
    }

    .preview-content h3 {
      font-size: 18px;
      font-weight: 600;
      margin: 24px 0 12px;
    }

    .preview-content p {
      margin-bottom: 16px;
    }

    .preview-content blockquote {
      border-left: 3px solid var(--accent-color);
      padding-left: 16px;
      margin: 16px 0;
      color: var(--text-secondary);
      font-style: italic;
    }

    .preview-content hr {
      height: 1px;
      background: var(--border-color);
      border: none;
      margin: 24px 0;
    }

    /* å³ä¾§è¾¹æ  */
    .sidebar-panel {
      background: var(--bg-primary);
      overflow-y: auto;
      padding: 20px;
    }

    .sidebar-section {
      margin-bottom: 24px;
    }

    .sidebar-title {
      font-size: 13px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: var(--text-tertiary);
      margin-bottom: 12px;
    }

    .knowledge-category {
      margin-bottom: 12px;
    }

    .knowledge-category-header {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      background: var(--bg-secondary);
      border-radius: var(--radius-sm);
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      transition: all 0.15s;
    }

    .knowledge-category-header:hover {
      background: var(--bg-tertiary);
    }

    .knowledge-category-icon {
      font-size: 16px;
    }

    .knowledge-category-name {
      flex: 1;
    }

    .knowledge-category-count {
      font-size: 12px;
      color: var(--text-tertiary);
      background: var(--bg-tertiary);
      padding: 2px 6px;
      border-radius: 10px;
    }

    .knowledge-items {
      margin-top: 8px;
      padding-left: 12px;
      display: none;
    }

    .knowledge-items.expanded {
      display: block;
    }

    .knowledge-item {
      padding: 8px 12px;
      margin-bottom: 4px;
      background: var(--bg-secondary);
      border-radius: var(--radius-sm);
      font-size: 13px;
      line-height: 1.5;
      cursor: pointer;
      transition: all 0.15s;
    }

    .knowledge-item:hover {
      background: var(--accent-color);
      color: white;
      transform: translateX(2px);
    }

    /* æ ·å¼é…ç½®é¢æ¿ */
    .style-config {
      background: var(--bg-secondary);
      border-radius: var(--radius-md);
      padding: 16px;
      margin-top: 16px;
    }

    .style-config-title {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 12px;
    }

    .style-option {
      margin-bottom: 12px;
    }

    .style-label {
      font-size: 12px;
      color: var(--text-secondary);
      margin-bottom: 6px;
      display: block;
    }

    .style-select {
      width: 100%;
      padding: 6px 10px;
      border: 1px solid var(--border-color);
      border-radius: var(--radius-sm);
      font-size: 13px;
      background: var(--bg-primary);
      cursor: pointer;
    }

    .style-input {
      width: 100%;
      padding: 6px 10px;
      border: 1px solid var(--border-color);
      border-radius: var(--radius-sm);
      font-size: 13px;
    }

    .color-picker {
      display: flex;
      gap: 8px;
      margin-top: 6px;
    }

    .color-option {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      cursor: pointer;
      border: 2px solid transparent;
      transition: all 0.15s;
    }

    .color-option:hover {
      transform: scale(1.1);
    }

    .color-option.selected {
      border-color: var(--accent-color);
      box-shadow: 0 0 0 2px rgba(34, 139, 230, 0.2);
    }

    /* Toastæç¤º */
    .toast {
      position: fixed;
      top: 80px;
      right: 24px;
      background: var(--text-primary);
      color: white;
      padding: 12px 20px;
      border-radius: var(--radius-md);
      box-shadow: var(--shadow-lg);
      opacity: 0;
      transform: translateY(-20px);
      transition: all 0.3s;
      z-index: 2000;
    }

    .toast.show {
      opacity: 1;
      transform: translateY(0);
    }
  </style>
</head>
<body>
  <!-- Toastæç¤º -->
  <div class="toast" id="toast"></div>

  <!-- é¡¶éƒ¨å·¥å…·æ  -->
  <div class="top-toolbar">
    <input type="text" class="draft-title-input" value="AIåˆ›ä¸šæ½®æ¥äº†:90åç¨‹åºå‘˜å‡­ChatGPTå¹´å…¥ç™¾ä¸‡çš„çœŸå®æ•…äº‹" readonly>
    <div class="save-indicator saved" id="saveIndicator">å·²ä¿å­˜ 2ç§’å‰</div>
    <div class="toolbar-actions">
      <select class="toolbar-btn secondary" style="padding: 0 12px;">
        <option>ä»Šæ—¥å¤´æ¡</option>
        <option selected>å…¬ä¼—å·</option>
      </select>
      <button class="toolbar-btn secondary" onclick="showToast('é¢„è§ˆåŠŸèƒ½å·²åœ¨ä¸­é—´é¢æ¿å®æ—¶æ˜¾ç¤º')">é¢„è§ˆ</button>
      <button class="toolbar-btn secondary" onclick="handleExport()">å¯¼å‡º</button>
      <button class="toolbar-btn primary" onclick="showToast('å‘å¸ƒåˆ°ä½œå“åº“åŠŸèƒ½å¼€å‘ä¸­...')">å‘å¸ƒ</button>
    </div>
  </div>

  <!-- ä¸»ç¼–è¾‘åŒºåŸŸ -->
  <div class="editor-layout">
    <!-- å·¦ä¾§:ç¼–è¾‘å™¨ -->
    <div class="editor-panel">
      <div class="editor-container">
        <textarea class="editor-title" placeholder="è¯·è¾“å…¥æ ‡é¢˜..." oninput="updatePreview()">AIåˆ›ä¸šæ½®æ¥äº†:90åç¨‹åºå‘˜å‡­ChatGPTå¹´å…¥ç™¾ä¸‡çš„çœŸå®æ•…äº‹</textarea>

        <div class="editor-content" id="editorContent">
          <div class="editor-block">
            <div class="block-handle">â‹®â‹®</div>
            <input type="text" class="editor-input" placeholder="è¾“å…¥ / æ’å…¥å†…å®¹å—,è¾“å…¥ @ å¼•ç”¨çŸ¥è¯†åº“..." value="æœ€è¿‘å’Œä¸€ä¸ªåšç¨‹åºå‘˜çš„æœ‹å‹èŠå¤©,ä»–å‘Šè¯‰æˆ‘ä¸€ä¸ªæƒŠäººçš„æ¶ˆæ¯:" oninput="handleInput(event)" onkeydown="handleKeydown(event)">
          </div>

          <div class="editor-block">
            <div class="block-handle">â‹®â‹®</div>
            <blockquote class="editor-quote">
              <input type="text" class="editor-input" value="é ChatGPTåšå‰¯ä¸š,ä¸‰ä¸ªæœˆèµšäº†30ä¸‡ã€‚" oninput="handleInput(event)">
            </blockquote>
          </div>

          <div class="editor-block">
            <div class="block-handle">â‹®â‹®</div>
            <input type="text" class="editor-input" value="æˆ‘ä¸€å¼€å§‹è¿˜ä¸ä¿¡,ç›´åˆ°çœ‹åˆ°ä»–çš„æ”¶å…¥æˆªå›¾å’Œå®¢æˆ·å¥½è¯„,æ‰çŸ¥é“è¿™æ˜¯çœŸçš„ã€‚" oninput="handleInput(event)" onkeydown="handleKeydown(event)">
          </div>

          <div class="editor-block">
            <div class="block-handle">â‹®â‹®</div>
            <h2 class="editor-heading-2">
              <input type="text" class="editor-input" value="ä»–æ˜¯æ€ä¹ˆåšåˆ°çš„?" oninput="handleInput(event)">
            </h2>
          </div>

          <div class="editor-block">
            <div class="block-handle">â‹®â‹®</div>
            <input type="text" class="editor-input" value="å…¶å®å¾ˆç®€å•,ä»–åšçš„å°±æ˜¯å¸®ä¼ä¸šå’Œä¸ªäººå®šåˆ¶AIè§£å†³æ–¹æ¡ˆ:" oninput="handleInput(event)">
          </div>

          <div class="editor-block">
            <div class="block-handle">â‹®â‹®</div>
            <input type="text" class="editor-input" value="1. ç”¨ChatGPTå†™è¥é”€æ–‡æ¡ˆ - å•å­æ”¶è´¹2000-5000" oninput="handleInput(event)">
          </div>

          <div class="editor-block">
            <div class="block-handle">â‹®â‹®</div>
            <input type="text" class="editor-input" value="2. å¼€å‘AIå®¢æœæœºå™¨äºº - æ¯ä¸ªé¡¹ç›®1-3ä¸‡" oninput="handleInput(event)">
          </div>

          <div class="editor-block">
            <div class="block-handle">â‹®â‹®</div>
            <input type="text" class="editor-input" value="3. åŸ¹è®­ä¼ä¸šå‘˜å·¥ä½¿ç”¨AIå·¥å…· - æ—¶è–ª500èµ·" oninput="handleInput(event)">
          </div>

          <div class="editor-block">
            <div class="block-handle">â‹®â‹®</div>
            <hr class="editor-divider">
          </div>

          <div class="editor-block">
            <div class="block-handle">â‹®â‹®</div>
            <input type="text" class="editor-input" value="è¿™è®©æˆ‘æƒ³èµ·ä¸€å¥è¯:" oninput="handleInput(event)">
          </div>

          <div class="editor-block">
            <div class="block-handle">â‹®â‹®</div>
            <blockquote class="editor-quote">
              <span class="reference-tag" onclick="showToast('æ¥è‡ª:é‡‘å¥åº“ - æ·±åº¦æ€è€ƒ')">çœŸæ­£çš„é«˜æ‰‹,éƒ½æ˜¯åœ¨åˆ«äººçœ‹ä¸è§çš„åœ°æ–¹ä¸‹åŠŸå¤«</span>
            </blockquote>
          </div>

          <div class="editor-block">
            <div class="block-handle">â‹®â‹®</div>
            <input type="text" class="editor-input" value="å½“åˆ«äººè¿˜åœ¨æ‹…å¿ƒAIä¼šä¸ä¼šæŠ¢èµ°å·¥ä½œ,èªæ˜äººå·²ç»åœ¨ç”¨AIèµšé’±äº†ã€‚" oninput="handleInput(event)">
          </div>
        </div>

        <!-- æ–œæ èœå• -->
        <div class="slash-menu" id="slashMenu">
          <div class="slash-menu-item" onclick="insertBlock('h1')">
            <span class="slash-menu-icon">H</span>
            <span class="slash-menu-label">å¤§æ ‡é¢˜</span>
            <span class="slash-menu-shortcut">/h1</span>
          </div>
          <div class="slash-menu-item" onclick="insertBlock('h2')">
            <span class="slash-menu-icon">H</span>
            <span class="slash-menu-label">ä¸­æ ‡é¢˜</span>
            <span class="slash-menu-shortcut">/h2</span>
          </div>
          <div class="slash-menu-item" onclick="insertBlock('h3')">
            <span class="slash-menu-icon">H</span>
            <span class="slash-menu-label">å°æ ‡é¢˜</span>
            <span class="slash-menu-shortcut">/h3</span>
          </div>
          <div class="slash-menu-item" onclick="insertBlock('quote')">
            <span class="slash-menu-icon">"</span>
            <span class="slash-menu-label">å¼•ç”¨å—</span>
            <span class="slash-menu-shortcut">/quote</span>
          </div>
          <div class="slash-menu-item" onclick="insertBlock('divider')">
            <span class="slash-menu-icon">â€”</span>
            <span class="slash-menu-label">åˆ†å‰²çº¿</span>
            <span class="slash-menu-shortcut">/hr</span>
          </div>
        </div>

        <!-- @ å¼•ç”¨èœå• -->
        <div class="reference-menu" id="referenceMenu">
          <div class="reference-category">é‡‘å¥åº“</div>
          <div class="reference-item" onclick="insertReference('çœŸæ­£çš„é«˜æ‰‹,éƒ½æ˜¯åœ¨åˆ«äººçœ‹ä¸è§çš„åœ°æ–¹ä¸‹åŠŸå¤«', 'é‡‘å¥åº“')">
            çœŸæ­£çš„é«˜æ‰‹,éƒ½æ˜¯åœ¨åˆ«äººçœ‹ä¸è§çš„åœ°æ–¹ä¸‹åŠŸå¤«
          </div>
          <div class="reference-item" onclick="insertReference('ä½ æ°¸è¿œèµšä¸åˆ°è®¤çŸ¥ä¹‹å¤–çš„é’±', 'é‡‘å¥åº“')">
            ä½ æ°¸è¿œèµšä¸åˆ°è®¤çŸ¥ä¹‹å¤–çš„é’±
          </div>
          <div class="reference-item" onclick="insertReference('æ‰€æœ‰å‘½è¿é¦ˆèµ çš„ç¤¼ç‰©,æ—©å·²åœ¨æš—ä¸­æ ‡å¥½äº†ä»·æ ¼', 'é‡‘å¥åº“')">
            æ‰€æœ‰å‘½è¿é¦ˆèµ çš„ç¤¼ç‰©,æ—©å·²åœ¨æš—ä¸­æ ‡å¥½äº†ä»·æ ¼
          </div>

          <div class="reference-category">æ ‡é¢˜å…¬å¼</div>
          <div class="reference-item" onclick="insertReference('ä¸ºä»€ä¹ˆ[åäºº]éƒ½åœ¨[åšæŸäº‹]?çœŸç›¸è®©äºº[æƒ…ç»ª]', 'æ ‡é¢˜å…¬å¼')">
            ä¸ºä»€ä¹ˆ[åäºº]éƒ½åœ¨[åšæŸäº‹]?çœŸç›¸è®©äºº[æƒ…ç»ª]
          </div>
          <div class="reference-item" onclick="insertReference('[æ•°å­—]ä¸ª[æ–¹æ³•],è®©ä½ [è¾¾æˆç›®æ ‡]', 'æ ‡é¢˜å…¬å¼')">
            [æ•°å­—]ä¸ª[æ–¹æ³•],è®©ä½ [è¾¾æˆç›®æ ‡]
          </div>
        </div>
      </div>
    </div>

    <!-- ä¸­é—´:é¢„è§ˆ -->
    <div class="preview-panel">
      <div class="preview-container" id="previewContainer">
        <h1 class="preview-title" id="previewTitle">AIåˆ›ä¸šæ½®æ¥äº†:90åç¨‹åºå‘˜å‡­ChatGPTå¹´å…¥ç™¾ä¸‡çš„çœŸå®æ•…äº‹</h1>
        <div class="preview-meta">
          <span>ä½œè€…:ç§‘æŠ€è§‚å¯Ÿå·</span>
          <span style="margin: 0 8px;">Â·</span>
          <span>2025-10-23</span>
        </div>
        <div class="preview-content" id="previewContent">
          <p>æœ€è¿‘å’Œä¸€ä¸ªåšç¨‹åºå‘˜çš„æœ‹å‹èŠå¤©,ä»–å‘Šè¯‰æˆ‘ä¸€ä¸ªæƒŠäººçš„æ¶ˆæ¯:</p>
          <blockquote>é ChatGPTåšå‰¯ä¸š,ä¸‰ä¸ªæœˆèµšäº†30ä¸‡ã€‚</blockquote>
          <p>æˆ‘ä¸€å¼€å§‹è¿˜ä¸ä¿¡,ç›´åˆ°çœ‹åˆ°ä»–çš„æ”¶å…¥æˆªå›¾å’Œå®¢æˆ·å¥½è¯„,æ‰çŸ¥é“è¿™æ˜¯çœŸçš„ã€‚</p>
          <h2>ä»–æ˜¯æ€ä¹ˆåšåˆ°çš„?</h2>
          <p>å…¶å®å¾ˆç®€å•,ä»–åšçš„å°±æ˜¯å¸®ä¼ä¸šå’Œä¸ªäººå®šåˆ¶AIè§£å†³æ–¹æ¡ˆ:</p>
          <p>1. ç”¨ChatGPTå†™è¥é”€æ–‡æ¡ˆ - å•å­æ”¶è´¹2000-5000</p>
          <p>2. å¼€å‘AIå®¢æœæœºå™¨äºº - æ¯ä¸ªé¡¹ç›®1-3ä¸‡</p>
          <p>3. åŸ¹è®­ä¼ä¸šå‘˜å·¥ä½¿ç”¨AIå·¥å…· - æ—¶è–ª500èµ·</p>
          <hr>
          <p>è¿™è®©æˆ‘æƒ³èµ·ä¸€å¥è¯:</p>
          <blockquote>çœŸæ­£çš„é«˜æ‰‹,éƒ½æ˜¯åœ¨åˆ«äººçœ‹ä¸è§çš„åœ°æ–¹ä¸‹åŠŸå¤«</blockquote>
          <p>å½“åˆ«äººè¿˜åœ¨æ‹…å¿ƒAIä¼šä¸ä¼šæŠ¢èµ°å·¥ä½œ,èªæ˜äººå·²ç»åœ¨ç”¨AIèµšé’±äº†ã€‚</p>
        </div>
      </div>
    </div>

    <!-- å³ä¾§:çŸ¥è¯†åº“ + æ ·å¼é…ç½® -->
    <div class="sidebar-panel">
      <div class="sidebar-section">
        <div class="sidebar-title">çŸ¥è¯†åº“å¼•ç”¨</div>

        <div class="knowledge-category">
          <div class="knowledge-category-header" onclick="toggleCategory(this)">
            <span class="knowledge-category-icon">ğŸ’</span>
            <span class="knowledge-category-name">é‡‘å¥åº“</span>
            <span class="knowledge-category-count">486</span>
          </div>
          <div class="knowledge-items">
            <div class="knowledge-item" onclick="insertReference('çœŸæ­£çš„é«˜æ‰‹,éƒ½æ˜¯åœ¨åˆ«äººçœ‹ä¸è§çš„åœ°æ–¹ä¸‹åŠŸå¤«', 'é‡‘å¥åº“')">
              çœŸæ­£çš„é«˜æ‰‹,éƒ½æ˜¯åœ¨åˆ«äººçœ‹ä¸è§çš„åœ°æ–¹ä¸‹åŠŸå¤«
            </div>
            <div class="knowledge-item" onclick="insertReference('ä½ æ°¸è¿œèµšä¸åˆ°è®¤çŸ¥ä¹‹å¤–çš„é’±', 'é‡‘å¥åº“')">
              ä½ æ°¸è¿œèµšä¸åˆ°è®¤çŸ¥ä¹‹å¤–çš„é’±,é™¤éé è¿æ°”
            </div>
            <div class="knowledge-item" onclick="insertReference('æˆå¹´äººçš„ä¸–ç•Œ,æ²¡æœ‰å®¹æ˜“äºŒå­—,é™¤äº†å‘èƒ–å’Œç©·', 'é‡‘å¥åº“')">
              æˆå¹´äººçš„ä¸–ç•Œ,æ²¡æœ‰å®¹æ˜“äºŒå­—,é™¤äº†å‘èƒ–å’Œç©·
            </div>
          </div>
        </div>

        <div class="knowledge-category">
          <div class="knowledge-category-header" onclick="toggleCategory(this)">
            <span class="knowledge-category-icon">ğŸ¯</span>
            <span class="knowledge-category-name">æ ‡é¢˜å…¬å¼</span>
            <span class="knowledge-category-count">38</span>
          </div>
          <div class="knowledge-items">
            <div class="knowledge-item" onclick="insertReference('ä¸ºä»€ä¹ˆ[åäºº]éƒ½åœ¨[åšæŸäº‹]?çœŸç›¸è®©äºº[æƒ…ç»ª]', 'æ ‡é¢˜å…¬å¼')">
              ä¸ºä»€ä¹ˆ[åäºº]éƒ½åœ¨[åšæŸäº‹]?çœŸç›¸è®©äºº[æƒ…ç»ª]
            </div>
            <div class="knowledge-item" onclick="insertReference('[æ•°å­—]ä¸ª[æ–¹æ³•],è®©ä½ [è¾¾æˆç›®æ ‡]', 'æ ‡é¢˜å…¬å¼')">
              [æ•°å­—]ä¸ª[æ–¹æ³•],è®©ä½ [è¾¾æˆç›®æ ‡]
            </div>
          </div>
        </div>

        <div class="knowledge-category">
          <div class="knowledge-category-header" onclick="toggleCategory(this)">
            <span class="knowledge-category-icon">ğŸ“„</span>
            <span class="knowledge-category-name">å†…å®¹æ¨¡æ¿</span>
            <span class="knowledge-category-count">25</span>
          </div>
          <div class="knowledge-items">
            <div class="knowledge-item" onclick="insertReference('æ˜¨å¤©åœ¨åœ°é“ä¸Š,æˆ‘çœ‹åˆ°ä¸€ä¸ªåœºæ™¯...', 'å¼€å¤´æ¨¡æ¿')">
              æ•…äº‹å‹å¼€å¤´:ä»ä¸€ä¸ªå…·ä½“åœºæ™¯åˆ‡å…¥
            </div>
            <div class="knowledge-item" onclick="insertReference('ä½ æ˜¯å¦ä¹Ÿæœ‰è¿™æ ·çš„å›°æƒ‘...', 'å¼€å¤´æ¨¡æ¿')">
              æé—®å‹å¼€å¤´:ç›´å‡»è¯»è€…ç—›ç‚¹
            </div>
          </div>
        </div>

        <div class="knowledge-category">
          <div class="knowledge-category-header" onclick="toggleCategory(this)">
            <span class="knowledge-category-icon">ğŸ“š</span>
            <span class="knowledge-category-name">ä½œè€…åº“</span>
            <span class="knowledge-category-count">12</span>
          </div>
          <div class="knowledge-items">
            <div class="knowledge-item" onclick="showToast('å‚è€ƒ:å¯ä¹åŠ å†° - æ“…é•¿å¨±ä¹å…«å¦,ç–‘é—®å¥å¼€å¤´')">
              å¯ä¹åŠ å†°(å¨±ä¹é¢†åŸŸ)
            </div>
            <div class="knowledge-item" onclick="showToast('å‚è€ƒ:å•†ä¸šè§‚å¯Ÿ - æ•°æ®å¼€å¤´,é€»è¾‘æ¸…æ™°')">
              å•†ä¸šè§‚å¯Ÿ(å•†ä¸šåˆ†æ)
            </div>
          </div>
        </div>
      </div>

      <div class="sidebar-section">
        <div class="sidebar-title">æ ·å¼é…ç½®(å…¬ä¼—å·)</div>

        <div class="style-config">
          <div class="style-config-title">é€‰æ‹©æ¨¡æ¿</div>
          <select class="style-select">
            <option>é»˜è®¤æ ·å¼</option>
            <option selected>ç§‘æŠ€è“</option>
            <option>ç®€çº¦é»‘</option>
            <option>ä¼˜é›…ç°</option>
            <option>è‡ªå®šä¹‰...</option>
          </select>
        </div>

        <div class="style-config">
          <div class="style-config-title">æ ‡é¢˜æ ·å¼</div>

          <div class="style-option">
            <label class="style-label">å­—ä½“å¤§å°</label>
            <input type="range" class="style-input" min="20" max="36" value="28" oninput="updateTitleSize(this.value)">
          </div>

          <div class="style-option">
            <label class="style-label">æ ‡é¢˜é¢œè‰²</label>
            <div class="color-picker">
              <div class="color-option selected" style="background: #000000;" onclick="selectColor(this, '#000000')"></div>
              <div class="color-option" style="background: #228be6;" onclick="selectColor(this, '#228be6')"></div>
              <div class="color-option" style="background: #f03e3e;" onclick="selectColor(this, '#f03e3e')"></div>
              <div class="color-option" style="background: #12b886;" onclick="selectColor(this, '#12b886')"></div>
            </div>
          </div>

          <div class="style-option">
            <label class="style-label">å¯¹é½æ–¹å¼</label>
            <select class="style-select">
              <option>å±…å·¦</option>
              <option selected>å±…ä¸­</option>
              <option>å±…å³</option>
            </select>
          </div>
        </div>

        <div class="style-config">
          <div class="style-config-title">æ­£æ–‡æ ·å¼</div>

          <div class="style-option">
            <label class="style-label">å­—ä½“å¤§å°</label>
            <input type="range" class="style-input" min="14" max="18" value="16">
          </div>

          <div class="style-option">
            <label class="style-label">è¡Œé—´è·</label>
            <select class="style-select">
              <option>1.5</option>
              <option selected>1.75</option>
              <option>2.0</option>
            </select>
          </div>
        </div>

        <div class="style-config">
          <div class="style-config-title">åº•éƒ¨å…ƒç´ </div>

          <div class="style-option">
            <label class="style-label">å…³æ³¨åŠ¨å›¾</label>
            <button class="toolbar-btn secondary" style="width: 100%; justify-content: center;" onclick="showToast('ä¸Šä¼ å…³æ³¨åŠ¨å›¾åŠŸèƒ½å¼€å‘ä¸­...')">ä¸Šä¼ å›¾ç‰‡</button>
          </div>

          <div class="style-option">
            <label class="style-label">äºŒç»´ç </label>
            <button class="toolbar-btn secondary" style="width: 100%; justify-content: center;" onclick="showToast('ä¸Šä¼ äºŒç»´ç åŠŸèƒ½å¼€å‘ä¸­...')">ä¸Šä¼ äºŒç»´ç </button>
          </div>

          <div class="style-option">
            <label class="style-label">ç­¾åæ¡£</label>
            <input type="text" class="style-input" placeholder="è¿™æ˜¯æˆ‘çš„ç­¾åæ¡£...">
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    let currentInput = null;
    let slashMenuActive = false;
    let referenceMenuActive = false;

    // å¤„ç†è¾“å…¥
    function handleInput(event) {
      const input = event.target;
      const value = input.value;

      // æ£€æµ‹æ–œæ å‘½ä»¤
      if (value === '/' || value.endsWith(' /')) {
        currentInput = input;
        showSlashMenu(input);
      } else {
        hideSlashMenu();
      }

      // æ£€æµ‹ @ å¼•ç”¨
      if (value.endsWith('@')) {
        currentInput = input;
        showReferenceMenu(input);
      } else {
        hideReferenceMenu();
      }

      // æ›´æ–°é¢„è§ˆ
      updatePreview();

      // æ¨¡æ‹Ÿè‡ªåŠ¨ä¿å­˜
      updateSaveIndicator();
    }

    // å¤„ç†é”®ç›˜äº‹ä»¶
    function handleKeydown(event) {
      if (event.key === 'Enter' && !slashMenuActive && !referenceMenuActive) {
        event.preventDefault();
        createNewBlock(event.target);
      }

      if (event.key === 'Escape') {
        hideSlashMenu();
        hideReferenceMenu();
      }
    }

    // æ˜¾ç¤ºæ–œæ èœå•
    function showSlashMenu(input) {
      const menu = document.getElementById('slashMenu');
      const rect = input.getBoundingClientRect();
      menu.style.left = rect.left + 'px';
      menu.style.top = (rect.bottom + 4) + 'px';
      menu.classList.add('active');
      slashMenuActive = true;
    }

    // éšè—æ–œæ èœå•
    function hideSlashMenu() {
      document.getElementById('slashMenu').classList.remove('active');
      slashMenuActive = false;
    }

    // æ˜¾ç¤ºå¼•ç”¨èœå•
    function showReferenceMenu(input) {
      const menu = document.getElementById('referenceMenu');
      const rect = input.getBoundingClientRect();
      menu.style.left = rect.left + 'px';
      menu.style.top = (rect.bottom + 4) + 'px';
      menu.classList.add('active');
      referenceMenuActive = true;
    }

    // éšè—å¼•ç”¨èœå•
    function hideReferenceMenu() {
      document.getElementById('referenceMenu').classList.remove('active');
      referenceMenuActive = false;
    }

    // æ’å…¥å†…å®¹å—
    function insertBlock(type) {
      if (!currentInput) return;

      const block = currentInput.closest('.editor-block');
      const newBlock = document.createElement('div');
      newBlock.className = 'editor-block';
      newBlock.innerHTML = '<div class="block-handle">â‹®â‹®</div>';

      let content = '';
      switch(type) {
        case 'h1':
          content = '<h1 class="editor-heading-1"><input type="text" class="editor-input" placeholder="å¤§æ ‡é¢˜..." oninput="handleInput(event)" onkeydown="handleKeydown(event)"></h1>';
          break;
        case 'h2':
          content = '<h2 class="editor-heading-2"><input type="text" class="editor-input" placeholder="ä¸­æ ‡é¢˜..." oninput="handleInput(event)" onkeydown="handleKeydown(event)"></h2>';
          break;
        case 'h3':
          content = '<h3 class="editor-heading-3"><input type="text" class="editor-input" placeholder="å°æ ‡é¢˜..." oninput="handleInput(event)" onkeydown="handleKeydown(event)"></h3>';
          break;
        case 'quote':
          content = '<blockquote class="editor-quote"><input type="text" class="editor-input" placeholder="å¼•ç”¨å†…å®¹..." oninput="handleInput(event)" onkeydown="handleKeydown(event)"></blockquote>';
          break;
        case 'divider':
          content = '<hr class="editor-divider">';
          break;
      }

      newBlock.innerHTML += content;
      block.parentNode.insertBefore(newBlock, block.nextSibling);

      currentInput.value = '';
      hideSlashMenu();

      if (type !== 'divider') {
        newBlock.querySelector('.editor-input').focus();
      }

      updatePreview();
    }

    // æ’å…¥å¼•ç”¨
    function insertReference(text, source) {
      if (!currentInput) {
        showToast('è¯·å…ˆå°†å…‰æ ‡å®šä½åˆ°ç¼–è¾‘å™¨ä¸­');
        return;
      }

      const value = currentInput.value;
      const newValue = value.replace(/@$/, '') + `<å¼•ç”¨:${text}>`;
      currentInput.value = newValue;

      // åˆ›å»ºå¼•ç”¨æ ‡ç­¾æ˜¾ç¤º
      const block = currentInput.closest('.editor-block');
      const tag = document.createElement('span');
      tag.className = 'reference-tag';
      tag.textContent = text;
      tag.onclick = () => showToast('æ¥è‡ª:' + source);

      // å¦‚æœæ˜¯å¼•ç”¨å—,ç›´æ¥æ›¿æ¢
      const quote = block.querySelector('.editor-quote');
      if (quote) {
        quote.innerHTML = '';
        quote.appendChild(tag);
      }

      hideReferenceMenu();
      updatePreview();
      showToast('å·²æ’å…¥å¼•ç”¨:' + source);
    }

    // åˆ›å»ºæ–°å—
    function createNewBlock(currentInput) {
      const block = currentInput.closest('.editor-block');
      const newBlock = document.createElement('div');
      newBlock.className = 'editor-block';
      newBlock.innerHTML = `
        <div class="block-handle">â‹®â‹®</div>
        <input type="text" class="editor-input" placeholder="è¾“å…¥ / æ’å…¥å†…å®¹å—,è¾“å…¥ @ å¼•ç”¨çŸ¥è¯†åº“..." oninput="handleInput(event)" onkeydown="handleKeydown(event)">
      `;

      block.parentNode.insertBefore(newBlock, block.nextSibling);
      newBlock.querySelector('.editor-input').focus();
    }

    // æ›´æ–°é¢„è§ˆ
    function updatePreview() {
      const title = document.querySelector('.editor-title').value;
      const blocks = document.querySelectorAll('.editor-block');

      document.getElementById('previewTitle').textContent = title || 'æ— æ ‡é¢˜';

      let content = '';
      blocks.forEach(block => {
        const h1 = block.querySelector('.editor-heading-1 .editor-input');
        const h2 = block.querySelector('.editor-heading-2 .editor-input');
        const h3 = block.querySelector('.editor-heading-3 .editor-input');
        const quote = block.querySelector('.editor-quote');
        const hr = block.querySelector('.editor-divider');
        const input = block.querySelector('.editor-input:not(.editor-heading-1 .editor-input):not(.editor-heading-2 .editor-input):not(.editor-heading-3 .editor-input):not(.editor-quote .editor-input)');

        if (h1) content += `<h1>${h1.value}</h1>`;
        else if (h2) content += `<h2>${h2.value}</h2>`;
        else if (h3) content += `<h3>${h3.value}</h3>`;
        else if (quote) {
          const tag = quote.querySelector('.reference-tag');
          if (tag) {
            content += `<blockquote>${tag.textContent}</blockquote>`;
          } else {
            const quoteInput = quote.querySelector('.editor-input');
            if (quoteInput && quoteInput.value) {
              content += `<blockquote>${quoteInput.value}</blockquote>`;
            }
          }
        }
        else if (hr) content += '<hr>';
        else if (input && input.value) content += `<p>${input.value}</p>`;
      });

      document.getElementById('previewContent').innerHTML = content;
    }

    // æ›´æ–°ä¿å­˜æŒ‡ç¤ºå™¨
    function updateSaveIndicator() {
      const indicator = document.getElementById('saveIndicator');
      indicator.textContent = 'ä¿å­˜ä¸­...';
      indicator.classList.remove('saved');

      setTimeout(() => {
        indicator.textContent = 'å·²ä¿å­˜ åˆšåˆš';
        indicator.classList.add('saved');
      }, 500);
    }

    // åˆ‡æ¢çŸ¥è¯†åº“åˆ†ç±»
    function toggleCategory(header) {
      const items = header.nextElementSibling;
      items.classList.toggle('expanded');
    }

    // é€‰æ‹©é¢œè‰²
    function selectColor(element, color) {
      document.querySelectorAll('.color-option').forEach(opt => opt.classList.remove('selected'));
      element.classList.add('selected');
      document.getElementById('previewTitle').style.color = color;
      showToast('å·²æ›´æ–°æ ‡é¢˜é¢œè‰²');
    }

    // æ›´æ–°æ ‡é¢˜å¤§å°
    function updateTitleSize(size) {
      document.getElementById('previewTitle').style.fontSize = size + 'px';
      showToast('å·²æ›´æ–°æ ‡é¢˜å¤§å°:' + size + 'px');
    }

    // å¯¼å‡ºåŠŸèƒ½
    function handleExport() {
      const title = document.querySelector('.editor-title').value;
      const content = document.getElementById('previewContent').innerHTML;

      const html = `
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <style>
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; max-width: 720px; margin: 40px auto; padding: 20px; }
    h1 { font-size: 28px; margin-bottom: 20px; }
    h2 { font-size: 22px; margin: 28px 0 14px; }
    h3 { font-size: 18px; margin: 24px 0 12px; }
    p { margin-bottom: 16px; line-height: 1.75; }
    blockquote { border-left: 3px solid #228be6; padding-left: 16px; margin: 16px 0; color: #495057; font-style: italic; }
    hr { margin: 24px 0; border: none; border-top: 1px solid #dee2e6; }
  </style>
</head>
<body>
  <h1>${title}</h1>
  ${content}
</body>
</html>
      `.trim();

      // å¤åˆ¶åˆ°å‰ªè´´æ¿
      navigator.clipboard.writeText(html).then(() => {
        showToast('å·²å¤åˆ¶HTMLåˆ°å‰ªè´´æ¿,å¯ç²˜è´´åˆ°å…¬ä¼—å·ç¼–è¾‘å™¨');
      });
    }

    // Toastæç¤º
    function showToast(message) {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.classList.add('show');
      setTimeout(() => {
        toast.classList.remove('show');
      }, 2000);
    }

    // åˆå§‹åŒ–
    updatePreview();
  </script>
</body>
</html>
